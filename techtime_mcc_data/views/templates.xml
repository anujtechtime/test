<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_payment_receipt_document_unpaid">
         <t t-call="web.external_layout">
            <t t-set="o" t-value="o.with_context(lang=lang)"/>
            <div class="page"> 
            <!-- <t t-if="o.name"> -->
            <!-- <t t-set="my_name" t-value="o.name.split('/')"/> -->
            <!-- </t> -->
            
  
  
              <div class="row mt32 text-center" id="informations" style="margin-bottom:5px;">
                
                
                <div class="col-4  ">
                   <!--<span class="m-0" t-field="o.name"/>-->
                   <!-- <span class="m-0" t-field="o.payment_number_temp"/><strong style="color : #000000;">: رقم الوصل </strong> -->
                    
                </div>
                
                <div class="col-4">
                    <!-- <strong style="color : #000000;">وصل قبض</strong> -->
                    
                </div>
                
                <div t-if="o.date_maturity" class="col-4 text-right">
                    <span class="m-0" t-field="o.date_maturity"/><strong style="color : #000000;"> :  التاريخ</strong>
                </div>
                <!--<div t-if="doc.validity_date and doc.state in ['draft', 'sent']" class="col-auto mw-100 mb-2" name="expiration_date">-->
                <!--    <strong>Expiration:</strong>-->
                <!--    <p class="m-0" t-field="doc.validity_date"/>-->
                <!--</div>-->
                <!--<div t-if="doc.user_id.name" class="col-auto mw-100 mb-2">-->
                <!--    <strong>Salesperson:</strong>-->
                <!--    <p class="m-0" t-field="doc.user_id"/>-->
                <!--</div>-->
            </div>
            
            
                  
                  
                  <div class="">
                
                <div class=" text-right" id="informations">
                  
                  <div class="col-12" style="margin-top: 10px;">
                  <div class="">
                    
                      <!-- <t t-if="o.partner_type"> -->
                          <strong style="color : #000000;">  اسم الطالب  : </strong>
                      <!-- </t> -->
                      <span t-field="o.partner_id"/>
                      
                  </div>
              </div>
              
                
                <div t-if="o" class="col-12" style="text-align : right;">
                    <strong style="color : #000000;">الكلية  : </strong><span t-field="o.partner_id.college" class="m-0"/>
                    
                </div>
                
                
                <div t-if="o" class="col-12" style="text-align : right;">
                    <strong style="color : #000000;">القسم :</strong> <span t-field="o.partner_id.department" class="m-0"/>
                    
                </div>
                
                
                <div t-if="o" class="col-12" style="">
                    <strong style="color : #000000;"> المرحلة  : </strong><span t-field="o.partner_id.level" class="m-0"/>
                    
                </div>
                
                <div t-if="o" class="col-12" style="">
                    <strong style="color : #000000;">دعم الطالب  : </strong><span t-field="o.partner_id.student_type" class="m-0"/>
                    
                </div>
                <div t-if="o" class="col-12" style="">
                    <strong style="color : #000000;">نوع الدراسة :</strong> <span t-field="o.partner_id.shift" class="m-0"/>
                    
                </div>
            </div>
            </div>

            <t t-set="balance_data" t-value="0"/>

                    <table class="table table-sm o_main_table" name="invoice_line_table">
                        <thead>
                            <tr>
                                <!-- TODO: remove in master -->
                                <t t-set="colspan" t-value="6"/>
                                <th name="th_description" class="text-right"><span>Date</span></th>
                                <!-- TODO: remove in master -->
                                <th name="th_source" class=" text-right"><span>Journal Entry</span></th>
                                <th name="th_quantity" class="text-right"><span>Label</span></th>
                                <!-- <th name="th_priceunit" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Debit</span></th>
                                <th name="th_price_unit" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                    <span>Credit</span>
                                </th> -->
                                <th name="th_taxes" t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Balance</span></th>
                            </tr>
                        </thead>
                        <tbody class="invoice_tbody">
                            <t t-set="current_subtotal" t-value="0"/>
                            <t t-set="lines" t-value="request.env['account.move.line'].sudo().search([('partner_id','=',o.partner_id.id),('move_id.state', '=', 'posted'),'|',('account_id.internal_type', '=', 'payable'),('account_id.internal_type', '=', 'receivable'),('full_reconcile_id', '=', False), ('balance', '!=', 0), ('account_id.reconcile', '=', True)])"/>

                            <t t-foreach="lines" t-as="line">
                                <!-- <t t-esc="line"/> -->
                                <!-- <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
 -->
                                <tr class="bg-200 font-weight-bold o_line_section">
                                    <t>
                                        <td name="account_invoice_line_name"><span t-field="line.date" t-options="{'widget': 'text'}"/></td>
                                        <td class="text-right">
                                            <span t-field="line.move_id"/>
                                        </td>
                                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                            <span class="text-nowrap" t-field="line.name"/>
                                        </td>
<!--                                         <td  t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                            <span class="text-nowrap" t-field="line.debit"/>
                                        </td>
                                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                                            <span t-esc="line.credit" id="line_tax_ids"/>
                                        </td> -->
                                        <td class="text-right o_price_total">
                                            <span class="text-nowrap" t-field="line.balance"/>
                                        </td>
                                        <t t-set="balance_data" t-value="balance_data + line.balance"/>

                                    </t>
                                    <!-- <t t-if="line.display_type == 'line_section'">
                                        <td colspan="99">
                                            <span t-field="line.name" t-options="{'widget': 'text'}"/>
                                        </td>
                                        <t t-set="current_section" t-value="line"/>
                                        <t t-set="current_subtotal" t-value="0"/>
                                    </t>
                                    <t t-if="line.display_type == 'line_note'">
                                        <td colspan="99">
                                            <span t-field="line.name" t-options="{'widget': 'text'}"/>
                                        </td>
                                    </t> -->
                                </tr>


                            </t>
                            <t t-if="">
                                    <tr class="is-subtotal text-right">
                                        <td colspan="99">
                                            
                                            <span
                                                t-esc="balance_data"
                                            />
                                            <strong class="mr16">المجموع</strong>
                                        </td>
                                    </tr>
                                </t>
                        </tbody>
                    </table>





              
            <div class="" style="float: left; position : fixed; left : 0; margin-top : 0px;">
                <div class="" style="text-align : right;">
                       <!-- <strong>   اسم وتوقيع امين الصندوق</strong> -->
                     </div>
                     
                </div>  
                
                
                <!-- <div class="" style="float: right; position : fixed; right : 0; margin-top : 0px;">
                <div class="" style="text-align : right;">
                       <strong>   انشأت بواسطة :</strong>    <span t-field="o.create_uid"/>
                     </div>
                     
                </div>   -->
                
                
            </div>
        </t>
       
        
            
    </template>

    <template id="report_payment_receipt_unpaid">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="lang" t-value="o.partner_id.lang or o.company_id.partner_id.lang"/>
                <t t-call="techtime_mcc_data.report_payment_receipt_document_unpaid" t-lang="lang"/>
            </t>
        </t>
    </template>
  </odoo>